# Changelog - foobar2000 Automation для macOS

Все важные изменения в проекте будут документированы в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Семантического версионирования](https://semver.org/lang/ru/).

## [Unreleased]

### Планируется
- Поддержка автоматических обновлений через Homebrew
- GUI приложение для управления профилями
- Интеграция с MusicBrainz для автоматического тегирования
- Поддержка DSD и других high-res форматов

## [1.0.1] - 2025-08-21

### Исправлено - Критические баги массовой конвертации
- **Исправлен вылет скрипта** при массовой конвертации файлов
- **Восстановлен вывод прогресса** LAME/FLAC/Opus во время конвертации
- **Устранены интерактивные запросы** в batch режиме массовой конвертации
- **Улучшена обработка ошибок** с graceful recovery

#### Технические исправления
- **Заменена логика поиска файлов** - убрана нестабильная process substitution
- **Добавлен флаг --batch** для неинтерактивного режима
- **Исправлена обработка массивов** с отключением set -e для критических участков
- **Убрано перенаправление >/dev/null** которое скрывало вывод конвертации

#### Затронутые файлы
- `scripts/foobar_menu_fish.sh` - исправлен основной цикл массовой конвертации
- `scripts/convert_with_external_advanced.sh` - добавлен batch режим
- `scripts/foobar2000_fish_functions.fish` - обновлены функции
- `scripts/foobar_integration_setup.sh` - улучшена интеграция

#### Результат
✅ Массовая конвертация теперь работает стабильно  
✅ Полный вывод прогресса с битрейтом и временем  
✅ Поддержка всех форматов: FLAC, MP3 (V0/320/Commercial), Opus  
✅ Автоматическое управление резервными копиями при замещении файлов

### Добавлено
- Документ `BUGFIXES.md` с детальным описанием исправлений
- Улучшенная диагностика и отладка в скриптах
- Безопасная обработка Unicode символов в именах файлов

## [1.0.0] - 2024-01-15

### Добавлено
- Первый стабильный релиз для macOS
- Полная адаптация Windows версии для macOS
- Поддержка Apple Silicon (M1/M2/M3) и Intel процессоров
- Автоматическая установка через Homebrew
- Три профиля установки: minimal, standard, professional

#### Основные скрипты
- `install.sh` - основной установочный скрипт с интерактивным и автоматическим режимами
- `components-downloader.sh` - автоматическая установка кодировщиков через Homebrew
- `config-generator.sh` - генерация конфигураций для различных профилей
- `validator.sh` - проверка корректности установки и настройки

#### Поддерживаемые кодировщики
- **FLAC** (1.4.3) - lossless кодирование с уровнями сжатия 0-8
- **LAME** (3.100) - MP3 кодирование с поддержкой CBR/VBR/ABR
- **Opus** (0.2) - современный lossy кодировщик
- **FFmpeg** (6.1) - универсальный мультимедиа фреймворк
- **MediaInfo** (23.11) - анализ метаданных
- **tag** (1.1.1) - редактирование аудио тегов

#### Интеграция с macOS
- Файловые ассоциации для аудиоформатов
- Поддержка Spotlight для поиска метаданных
- QuickLook предпросмотр аудиофайлов
- Notification Center уведомления
- Поддержка медиа-клавиш
- Dock интеграция с прогрессом

#### Конфигурационные файлы
- Пресеты кодировщиков адаптированные для macOS
- Masstagger скрипты с поддержкой Unicode
- Шаблоны для интеграции с системными службами macOS
- JSON файлы совместимости для различных версий macOS

#### Документация
- Подробное руководство по установке
- Руководство по устранению проблем
- Руководство по кастомизации
- Руководство по оптимизации производительности
- Матрица совместимости macOS версий

### Изменено по сравнению с Windows версией
- Использование Homebrew вместо прямых загрузок
- Адаптация путей для macOS файловой системы
- Оптимизация для Apple Silicon архитектуры
- Замена Windows-специфичных компонентов на macOS аналоги
- Интеграция с системными службами macOS

### Исправлено
- Проблемы с Unicode путями на macOS
- Корректная обработка пробелов в именах файлов
- Определение архитектуры процессора (Intel/Apple Silicon)
- Правильные пути к Homebrew для разных архитектур

### Безопасность
- Валидация всех загружаемых компонентов
- Проверка подписей Homebrew пакетов
- Совместимость с macOS Gatekeeper
- Поддержка System Integrity Protection (SIP)

## [0.9.0] - 2024-01-01

### Добавлено
- Начальная адаптация для macOS
- Базовая поддержка Homebrew установки
- Тестирование на Apple Silicon

### Изменено
- Переработка скриптов для bash совместимости
- Адаптация путей для macOS

## Планы развития

### Версия 1.1.0
- Поддержка дополнительных форматов (DSD, MQA)
- Автоматическое обновление конфигураций
- Расширенная интеграция с Finder
- Поддержка iCloud синхронизации настроек

### Версия 1.2.0
- GUI приложение для управления
- Плагин архитектура для расширений
- Автоматическое тегирование через MusicBrainz
- Batch processing с прогресс индикацией

### Версия 2.0.0
- Полная переработка архитектуры
- Поддержка streaming сервисов
- Интеграция с Apple Music/iTunes
- Machine Learning для автоматической обработки

## Совместимость

### Поддерживаемые версии macOS
- macOS 14.0 Sonoma ✅ (рекомендуется)
- macOS 13.0 Ventura ✅ (рекомендуется)  
- macOS 12.0 Monterey ✅
- macOS 11.0 Big Sur ⚠️ (минимальная)
- macOS 10.15 Catalina ❌ (не поддерживается)

### Поддерживаемые архитектуры
- Apple Silicon (M1/M2/M3) ✅ (оптимизировано)
- Intel x86_64 ✅ (полная поддержка)

### Версии foobar2000
- foobar2000 v2.1 ✅ (тестировано)
- foobar2000 v2.0 ✅ (совместимо)

## Участие в разработке

### Как сообщить об ошибке
1. Проверьте [существующие issues](https://github.com/your-repo/foobar2000-automation-macos/issues)
2. Создайте новый issue с подробным описанием
3. Приложите диагностическую информацию:
   ```bash
   # Системная информация
   sw_vers
   uname -m
   
   # Версии компонентов  
   brew --version
   brew list --versions flac lame opus-tools
   
   # Логи выполнения
   ./scripts/validator.sh --detailed
   ```

### Как предложить улучшение
1. Опишите предлагаемую функциональность
2. Объясните, как это улучшит пользовательский опыт
3. Предоставьте примеры использования

### Участие в разработке
1. Fork репозитория
2. Создайте feature branch (`git checkout -b feature/amazing-feature`)
3. Commit изменения (`git commit -m 'Add amazing feature'`)
4. Push в branch (`git push origin feature/amazing-feature`)
5. Откройте Pull Request

## Лицензия

Этот проект распространяется под лицензией MIT. Подробности в файле [LICENSE](LICENSE).

## Благодарности

- Команде разработчиков foobar2000 за отличный аудиоплеер
- Сообществу Homebrew за удобную систему пакетов macOS
- Всем контрибьюторам и тестировщикам проекта

---

**Статус проекта:** Активная разработка  
**Поддержка:** macOS 11.0+, Apple Silicon + Intel  
**Лицензия:** MIT